# Swiftå®˜æ–¹æ–‡æ¡£ç¬”è®°
#Swift/åŸºç¡€


Double ç²¾ç¡®åº¦å¾ˆé«˜ï¼Œè‡³å°‘æœ‰15ä½æ•°å­—ï¼Œè€Œ Float åªæœ‰6ä½æ•°å­—ã€‚é€‰æ‹©å“ªä¸ªç±»å‹å–å†³äºä½ çš„ä»£ç éœ€è¦å¤„ç†çš„å€¼çš„èŒƒå›´ï¼Œåœ¨ä¸¤ç§ç±»å‹éƒ½åŒ¹é…çš„æƒ…å†µä¸‹ï¼Œå°†ä¼˜å…ˆé€‰æ‹© Doubleã€‚

å½“æ¨æ–­æµ®ç‚¹æ•°çš„ç±»å‹æ—¶ï¼ŒSwift æ€»æ˜¯ä¼šé€‰æ‹© Double è€Œä¸æ˜¯ Floatã€‚

åè¿›åˆ¶æµ®ç‚¹æ•°ä¹Ÿå¯ä»¥æœ‰ä¸€ä¸ªå¯é€‰çš„æŒ‡æ•°ï¼ˆexponent)ï¼Œé€šè¿‡å¤§å†™æˆ–è€…å°å†™çš„ e æ¥æŒ‡å®šï¼›åå…­è¿›åˆ¶æµ®ç‚¹æ•°å¿…é¡»æœ‰ä¸€ä¸ªæŒ‡æ•°ï¼Œé€šè¿‡å¤§å†™æˆ–è€…å°å†™çš„ p æ¥æŒ‡å®šã€‚
1.25e2 è¡¨ç¤º 1.25 Ã— 10^2ï¼Œç­‰äº 125.0ã€‚
1.25e-2 è¡¨ç¤º 1.25 Ã— 10^-2ï¼Œç­‰äº 0.0125ã€‚
0xFp2 è¡¨ç¤º 15 Ã— 2^2ï¼Œç­‰äº 60.0ã€‚
0xFp-2 è¡¨ç¤º 15 Ã— 2^-2ï¼Œç­‰äº 3.75ã€‚

æ•°å€¼ç±»å­—é¢é‡å¯ä»¥åŒ…æ‹¬é¢å¤–çš„æ ¼å¼æ¥å¢å¼ºå¯è¯»æ€§ã€‚æ•´æ•°å’Œæµ®ç‚¹æ•°éƒ½å¯ä»¥æ·»åŠ é¢å¤–çš„é›¶å¹¶ä¸”åŒ…å«ä¸‹åˆ’çº¿ï¼Œå¹¶ä¸ä¼šå½±å“å­—é¢é‡ï¼š
``` swift
let paddedDouble = 000123.456
let oneMillion = 1_000_000
let justOverOneMillion = 1_000_000.000_000_1
```

ç±»å‹è½¬æ¢å…¶å®æ˜¯ä¸€ä¸ªåˆå§‹åŒ–æ„é€ å™¨ã€‚

åœ¨ Objective-C ä¸­ï¼Œnil æ˜¯ä¸€ä¸ªæŒ‡å‘ä¸å­˜åœ¨å¯¹è±¡çš„æŒ‡é’ˆã€‚åœ¨ Swift ä¸­ï¼Œnil ä¸æ˜¯æŒ‡é’ˆâ€”â€”å®ƒæ˜¯ä¸€ä¸ªç¡®å®šçš„å€¼ï¼Œç”¨æ¥è¡¨ç¤ºå€¼ç¼ºå¤±ã€‚

fatalError(_:file:line:)ä¸ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼ŒpreconditionFailure(_:file:line:)ä½¿ç”¨ unchecked æ¨¡å¼ï¼ˆ-Ouncheckedï¼‰ç¼–è¯‘ä»£ç ä¼šè¢«ä¼˜åŒ–ï¼Œassert(_:_:file:line:)ç”Ÿæˆé˜¶æ®µä¼šè¢«ä¼˜åŒ–ï¼Œéƒ½æ˜¯æ˜¯åœ¨è¿è¡Œæ—¶æ‰€åšçš„æ£€æŸ¥ã€‚

Swiftç®—æœ¯è¿ç®—ç¬¦ï¼ˆ+ï¼Œ-ï¼Œ*ï¼Œ/ï¼Œ% ç­‰ï¼‰çš„ç»“æœä¼šè¢«æ£€æµ‹å¹¶ç¦æ­¢å€¼æº¢å‡ºï¼Œå®‰å…¨ã€‚

Swift ä¹Ÿæä¾›æ’ç­‰ï¼ˆ===ï¼‰å’Œä¸æ’ç­‰ï¼ˆ!==ï¼‰è¿™ä¸¤ä¸ªæ¯”è¾ƒç¬¦æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡å®ä¾‹ã€‚


Swiftæ¯ä¸€ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ç”±ç¼–ç æ— å…³çš„ Unicode å­—ç¬¦ç»„æˆï¼Œå¹¶æ”¯æŒè®¿é—®å­—ç¬¦çš„å¤šç§ Unicode è¡¨ç¤ºå½¢å¼ã€‚

```swift
let sparklingHeart = "\u{1F496}" // ğŸ’–ï¼ŒUnicode æ ‡é‡ U+1F496
```

 Swift ä¸­çš„å­—ç¬¦åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­å¹¶ä¸ä¸€å®šå ç”¨ç›¸åŒçš„å†…å­˜ç©ºé—´æ•°é‡ï¼ŒSwiftå­—ç¬¦ä¸²é€šè¿‡ count å±æ€§è¿”å›çš„å­—ç¬¦æ•°é‡å¹¶ä¸æ€»æ˜¯ä¸åŒ…å«ç›¸åŒå­—ç¬¦çš„ NSString çš„ length å±æ€§ç›¸åŒã€‚NSString çš„ length å±æ€§æ˜¯åˆ©ç”¨ UTF-16 è¡¨ç¤ºçš„åå…­ä½ä»£ç å•å…ƒæ•°å­—ï¼Œè€Œä¸æ˜¯ Unicode å¯æ‰©å±•çš„å­—ç¬¦ç¾¤é›†ã€‚

Substringé€‚ç”¨äºçŸ­æœŸå­˜å‚¨å¹¶å…±äº«åŸæ¥çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥ä½¿ç”¨String(SubString)æ¥é‡æ–°åˆå§‹åŒ–ä¸€ä¸ªStringå¹¶å­˜å‚¨åœ¨æ–°çš„å†…å­˜ä¸Šã€‚
![](Swift%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/38DA15ED-DFC7-4FF9-83E5-0BC8F7113689.png)

è®¿é—®å­—ç¬¦çš„utf-16ã€utf-8ã€utf-32ç¼–ç ï¼Œä¾æ¬¡ä½¿ç”¨utf8ã€utf16ã€unicodeScalars
```swift
for codeUnit in dogString.utf16 {
print("\(codeUnit) ", terminator: "")
}
print("")
// 68 111 103 8252 55357 56374
```

é›†åˆæ“ä½œ
```swift
let houseAnimals: Set = ["ğŸ¶", "ğŸ±"]
let farmAnimals: Set = ["ğŸ®", "ğŸ”", "ğŸ‘", "ğŸ¶", "ğŸ±"]
let cityAnimals: Set = ["ğŸ¦", "ğŸ­"]

houseAnimals.isSubset(of: farmAnimals)
// true
farmAnimals.isSuperset(of: houseAnimals)
// true
farmAnimals.isDisjoint(with: cityAnimals)
// true
```

updateValue(_:forKey:) æ–¹æ³•ä¼šè¿”å›å¯¹åº”å€¼ç±»å‹çš„å¯é€‰ç±»å‹ï¼Œå¦‚æœæœ‰å€¼å­˜åœ¨äºæ›´æ–°å‰ï¼Œåˆ™è¿™ä¸ªå¯é€‰å€¼åŒ…å«äº†æ—§å€¼ï¼Œå¦åˆ™å®ƒå°†ä¼šæ˜¯ nilã€‚
```swift
if let oldValue = airports.updateValue("Dublin Airport", forKey: "DUB") {
print("The old value for DUB was \(oldValue).")
}
// è¾“å‡ºâ€œThe old value for DUB was Dublin.â€

```

ä½¿ç”¨æ ‡ç­¾ï¼ˆ*statement label*ï¼‰æ¥æ ‡è®°ä¸€ä¸ªå¾ªç¯ä½“æˆ–è€…æ¡ä»¶è¯­å¥
```swift
gameLoop: while square != finalSquare {
    diceRoll += 1
    if diceRoll == 7 { diceRoll = 1 }
    switch square + diceRoll {
    case finalSquare:
        // éª°å­æ•°åˆšå¥½ä½¿ç©å®¶ç§»åŠ¨åˆ°æœ€ç»ˆçš„æ–¹æ ¼é‡Œï¼Œæ¸¸æˆç»“æŸã€‚
        break gameLoop
    case let newSquare where newSquare > finalSquare:
        // éª°å­æ•°å°†ä¼šä½¿ç©å®¶çš„ç§»åŠ¨è¶…å‡ºæœ€åçš„æ–¹æ ¼ï¼Œé‚£ä¹ˆè¿™ç§ç§»åŠ¨æ˜¯ä¸åˆæ³•çš„ï¼Œç©å®¶éœ€è¦é‡æ–°æ·éª°å­
        continue gameLoop
    default:
        // åˆæ³•ç§»åŠ¨ï¼Œåšæ­£å¸¸çš„å¤„ç†
        square += diceRoll
        square += board[square]
    }
}
print("Game over!")
```


å…¨å±€å‡½æ•°æ˜¯ä¸€ä¸ªæœ‰åå­—ä½†ä¸ä¼šæ•è·ä»»ä½•å€¼çš„é—­åŒ…
åµŒå¥—å‡½æ•°æ˜¯ä¸€ä¸ªæœ‰åå­—å¹¶å¯ä»¥æ•è·å…¶å°é—­å‡½æ•°åŸŸå†…å€¼çš„é—­åŒ…
é—­åŒ…è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªåˆ©ç”¨è½»é‡çº§è¯­æ³•æ‰€å†™çš„å¯ä»¥æ•è·å…¶ä¸Šä¸‹æ–‡ä¸­å˜é‡æˆ–å¸¸é‡å€¼çš„åŒ¿åé—­åŒ…

Swifté—­åŒ…æ˜¯å¼•ç”¨ç±»å‹ï¼Œè¿™é‡Œæ•è·äº† runningTotal å’Œ amount å˜é‡çš„*å¼•ç”¨*ã€‚æ•è·å¼•ç”¨ä¿è¯äº† runningTotal å’Œ amount å˜é‡åœ¨è°ƒç”¨å®Œ makeIncrementer åä¸ä¼šæ¶ˆå¤±ï¼Œå¹¶ä¸”ä¿è¯äº†åœ¨ä¸‹ä¸€æ¬¡æ‰§è¡Œ incrementer å‡½æ•°æ—¶ï¼ŒrunningTotal ä¾æ—§å­˜åœ¨ã€‚
```swift
func incrementer() -> Int {
runningTotal += amount
return runningTotal
}

incrementByTen()
// è¿”å›çš„å€¼ä¸º10
incrementByTen()
// è¿”å›çš„å€¼ä¸º20
incrementByTen()
// è¿”å›çš„å€¼ä¸º30
```

ä»¤æšä¸¾éµå¾ª CaseIterable åè®®ã€‚Swift ä¼šç”Ÿæˆä¸€ä¸ª allCases å±æ€§ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªåŒ…å«æšä¸¾æ‰€æœ‰æˆå‘˜çš„é›†åˆã€‚

indirect æ¥è¡¨ç¤ºè¯¥æšä¸¾æˆå‘˜å¯é€’å½’ï¼Œä¸€èˆ¬ä¸è¦ç”¨ï¼Œå¤„ç†èµ·æ¥ä¸€èˆ¬è¦é…åˆé€’å½’ï¼Œå¦‚æœæ•°æ®é‡å¤§ï¼Œå¼€é”€ä¼šå¾ˆå¤§ã€‚
```swift
enum ArithmeticExpression {
    case number(Int)
    indirect case addition(ArithmeticExpression, ArithmeticExpression)
    indirect case multiplication(ArithmeticExpression, ArithmeticExpression)
}

let five = ArithmeticExpression.number(5)
let four = ArithmeticExpression.number(4)
let sum = ArithmeticExpression.addition(five, four)
let product = ArithmeticExpression.multiplication(sum, ArithmeticExpression.number(2))
```

ç±»æ¯”ç»“æ„ä½“å¤šä»¥ä¸‹ç‰¹æ€§ï¼š
ç»§æ‰¿ã€å¼•ç”¨è®¡æ•°ã€ææ„ã€ç±»å‹è½¬æ¢å…è®¸åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œè§£é‡Šä¸€ä¸ªç±»å®ä¾‹çš„ç±»å‹

å¦‚æœä¸€ä¸ªè¢«æ ‡è®°ä¸º lazy çš„å±æ€§åœ¨æ²¡æœ‰åˆå§‹åŒ–æ—¶å°±åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œåˆ™æ— æ³•ä¿è¯è¯¥å±æ€§åªä¼šè¢«åˆå§‹åŒ–ä¸€æ¬¡ã€‚

åœ¨çˆ¶ç±»åˆå§‹åŒ–æ–¹æ³•è°ƒç”¨ä¹‹åï¼Œåœ¨å­ç±»æ„é€ å™¨ä¸­ç»™çˆ¶ç±»çš„å±æ€§èµ‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨çˆ¶ç±»å±æ€§çš„ willSet å’Œ didSet è§‚å¯Ÿå™¨ã€‚
çˆ¶ç±»åˆå§‹åŒ–æ–¹æ³•è°ƒç”¨ä¹‹å‰ï¼Œç»™å­ç±»çš„å±æ€§èµ‹å€¼æ—¶ä¸ä¼šè°ƒç”¨å­ç±»å±æ€§çš„è§‚å¯Ÿå™¨ã€‚

å¸¦æœ‰è§‚å¯Ÿå™¨çš„å±æ€§é€šè¿‡ in-out æ–¹å¼ä¼ å…¥å‡½æ•°ï¼ŒwillSet å’Œ didSet ä¹Ÿä¼šè°ƒç”¨ã€‚è¿™é‡Œé‡‡ç”¨äº†æ‹·å…¥æ‹·å‡ºå†…å­˜æ¨¡å¼ï¼šå³åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„æ˜¯å‚æ•°çš„ copyï¼Œå‡½æ•°ç»“æŸåï¼Œåˆå¯¹å‚æ•°é‡æ–°èµ‹å€¼ã€‚

Swiftå¯ä»¥é€šè¿‡@propertyWrapperæ ‡è®°ä¸€ä¸ªå±æ€§åŒ…è£…å™¨ï¼Œå½“ä½ æŠŠä¸€ä¸ªåŒ…è£…å™¨åº”ç”¨åˆ°ä¸€ä¸ªå±æ€§ä¸Šæ—¶ï¼Œç¼–è¯‘å™¨å°†åˆæˆæä¾›åŒ…è£…å™¨å­˜å‚¨ç©ºé—´å’Œé€šè¿‡åŒ…è£…å™¨è®¿é—®å±æ€§çš„ä»£ç ã€‚ï¼ˆå±æ€§åŒ…è£…å™¨åªè´Ÿè´£å­˜å‚¨è¢«åŒ…è£…å€¼ï¼Œæ‰€ä»¥æ²¡æœ‰åˆæˆè¿™äº›ä»£ç ã€‚ï¼‰ä¸åˆ©ç”¨è¿™ä¸ªç‰¹æ€§è¯­æ³•çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥å†™å‡ºä½¿ç”¨å±æ€§åŒ…è£…å™¨è¡Œä¸ºçš„ä»£ç ã€‚
```swift
@propertyWrapper
struct TwelveOrLess {
    private var number: Int
    init() { self.number = 0 }
    var wrappedValue: Int {
        get { return number }
        set { number = min(newValue, 12) }
    }
}

struct SmallRectangle {
@TwelveOrLess var height: Int
@TwelveOrLess var width: Int
}

var rectangle = SmallRectangle()
print(rectangle.height)
// æ‰“å° "0"

rectangle.height = 10
print(rectangle.height)
// æ‰“å° "10"

rectangle.height = 24
print(rectangle.height)
// æ‰“å° "12"

```


å…¨å±€çš„å¸¸é‡æˆ–å˜é‡éƒ½æ˜¯å»¶è¿Ÿlazyè®¡ç®—çš„ï¼Œè·Ÿ  [å»¶æ—¶åŠ è½½å­˜å‚¨å±æ€§](applewebdata://07ADC17B-305B-41BA-B39C-412958A13E79/swift/swift-jiao-cheng/10_properties#lazy-stored-properties)  ç›¸ä¼¼ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œå…¨å±€çš„å¸¸é‡æˆ–å˜é‡ä¸éœ€è¦æ ‡è®° lazy ä¿®é¥°ç¬¦ã€‚

å­˜å‚¨å‹ç±»å‹å±æ€§æ˜¯å»¶è¿Ÿåˆå§‹åŒ–çš„ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„æ—¶å€™æ‰ä¼šè¢«åˆå§‹åŒ–ï¼ŒåŒæ—¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¹¶ä¸”ä¸éœ€è¦å¯¹å…¶ä½¿ç”¨ lazy ä¿®é¥°ç¬¦ã€‚

class å’Œ staticçš„åŒºåˆ«æ˜¯å®ƒå…è®¸å­ç±»é‡å†™ã€‚

ç»“æ„ä½“æ„é€ å™¨åµŒå¥—ä½¿ç”¨ã€‚
```swift
struct Rect {
    var origin = Point()
    var size = Size()
    init() {}

    init(origin: Point, size: Size) {
        self.origin = origin
        self.size = size
    }

    init(center: Point, size: Size) {
        let originX = center.x - (size.width / 2)
        let originY = center.y - (size.height / 2)
        self.init(origin: Point(x: originX, y: originY), size: size)
    }
}
```

æ¯ä¸€ä¸ªç±»éƒ½å¿…é¡»è‡³å°‘æ‹¥æœ‰ä¸€ä¸ªæŒ‡å®šæ„é€ å™¨ï¼ŒæŒ‡å®šæ„é€ å™¨åƒä¸€ä¸ªä¸ªâ€œæ¼æ–—â€æ”¾åœ¨æ„é€ è¿‡ç¨‹å‘ç”Ÿçš„åœ°æ–¹ï¼Œè®©æ„é€ è¿‡ç¨‹æ²¿ç€çˆ¶ç±»é“¾ç»§ç»­å¾€ä¸Šè¿›è¡Œã€‚

æŒ‡å®šæ„é€ å™¨å¿…é¡»æ€»æ˜¯*å‘ä¸Š*ä»£ç†ï¼Œä¾¿åˆ©æ„é€ å™¨å¿…é¡»æ€»æ˜¯*æ¨ªå‘*ä»£ç†
![](Swift%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/2DD2C258-5D5B-420A-81A3-EAE329262BC6.png)
æŒ‡å®šæ„é€ å™¨å¿…é¡»è°ƒç”¨å…¶ç›´æ¥çˆ¶ç±»çš„çš„æŒ‡å®šæ„é€ å™¨ã€‚
ä¾¿åˆ©æ„é€ å™¨å¿…é¡»è°ƒç”¨*åŒ*ç±»ä¸­å®šä¹‰çš„å…¶å®ƒæ„é€ å™¨ã€‚
ä¾¿åˆ©æ„é€ å™¨æœ€åå¿…é¡»è°ƒç”¨æŒ‡å®šæ„é€ å™¨ã€‚

Swiftçš„æ„é€ å¯ä»¥åˆ†ä¸º2ä¸ªè¿‡ç¨‹ï¼š
1. æŒ‡å®šæ„é€ å™¨å°†ç¡®ä¿æ‰€æœ‰å­ç±»çš„å±æ€§éƒ½æœ‰å€¼ï¼Œç„¶åå®ƒå°†è°ƒç”¨çˆ¶ç±»çš„æŒ‡å®šæ„é€ å™¨ï¼Œå¹¶æ²¿ç€ç»§æ‰¿é“¾ä¸€ç›´å¾€ä¸Šå®Œæˆçˆ¶ç±»çš„æ„é€ è¿‡ç¨‹ç›´åˆ°æ²¡æœ‰çˆ¶ç±»ï¼Œä¸€æ—¦çˆ¶ç±»ä¸­æ‰€æœ‰å±æ€§éƒ½æœ‰äº†åˆå§‹å€¼ï¼Œå®ä¾‹çš„å†…å­˜è¢«è®¤ä¸ºæ˜¯å®Œå…¨åˆå§‹åŒ–ï¼Œé˜¶æ®µ 1 å®Œæˆã€‚ã€‚
2. çˆ¶ç±»å¼€å§‹æœ‰æœºä¼šè¿›ä¸€æ­¥è‡ªå®šä¹‰å®ä¾‹ï¼Œå±‚å±‚å¾€ä¸‹ç›´åˆ°å­ç±»ä¹Ÿæœ‰æœºä¼šè¿›ä¸€æ­¥è‡ªå®šä¹‰å®ä¾‹ï¼Œå­ç±»æŒ‡å®šæ„é€ å™¨å®Œæˆè°ƒç”¨ï¼Œåˆ™æ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚

Swifté»˜è®¤ä¸ä¼šç»§æ‰¿çˆ¶ç±»æ„é€ å™¨ï¼Œåœ¨ä¸€äº›ç‰¹å®šæ¡ä»¶ä¼šã€‚
Swiftææ„å‡½æ•°åœ¨å®ä¾‹é‡Šæ”¾å‘ç”Ÿå‰è¢«è‡ªåŠ¨è°ƒç”¨çš„ï¼Œç±»ç»§æ‰¿äº†çˆ¶ç±»çš„ææ„å™¨ï¼Œå¹¶ä¸”åœ¨å­ç±»ææ„å™¨å®ç°çš„æœ€åï¼Œçˆ¶ç±»çš„ææ„å™¨ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚

defer è¯­å¥è°ƒç”¨å‘ç”Ÿåœ¨returnä¹‹åï¼Œç¦»å¼€ä¹‹å‰ã€‚

*ç±»å‹æ£€æŸ¥æ“ä½œç¬¦*ï¼ˆisï¼‰æ¥æ£€æŸ¥ä¸€ä¸ªå®ä¾‹æ˜¯å¦å±äºç‰¹å®šå­ç±»å‹
Any å¯ä»¥è¡¨ç¤ºä»»ä½•ç±»å‹ï¼ŒåŒ…æ‹¬å‡½æ•°ç±»å‹ã€å¯é€‰å€¼ã€‚
AnyObject å¯ä»¥è¡¨ç¤ºä»»ä½•ç±»ç±»å‹çš„å®ä¾‹ã€‚

Swift ä¸­çš„æ‰©å±•å¯ä»¥ï¼š
* æ·»åŠ è®¡ç®—å‹å®ä¾‹å±æ€§å’Œè®¡ç®—å‹ç±»å±æ€§
* å®šä¹‰å®ä¾‹æ–¹æ³•å’Œç±»æ–¹æ³•
* æä¾›æ–°çš„æ„é€ å™¨
* å®šä¹‰ä¸‹æ ‡
* å®šä¹‰å’Œä½¿ç”¨æ–°çš„åµŒå¥—ç±»å‹
* ä½¿å·²ç»å­˜åœ¨çš„ç±»å‹éµå¾ªï¼ˆconformï¼‰ä¸€ä¸ªåè®®

required ä¿®é¥°ç¬¦å¯ä»¥ç¡®ä¿æ‰€æœ‰å­ç±»ä¹Ÿå¿…é¡»æä¾›æ­¤æ„é€ å™¨å®ç°ï¼Œä»è€Œä¹Ÿèƒ½éµå¾ªåè®®ã€‚

ä¸ºåè®®æ‰©å±•æ·»åŠ é™åˆ¶æ¡ä»¶
```swift
extension Collection where Element: Equatable {
    func allEqual() -> Bool {
        for element in self {
            if element != self.first {
                return false
            }
        }
        return true
    }
}
```

èŒƒå‹ç±»å‹çº¦æŸè¯­æ³•
```swift
func someFunction<T: SomeClass, U: SomeProtocol>(someT: T, someU: U) {
    // è¿™é‡Œæ˜¯æ³›å‹å‡½æ•°çš„å‡½æ•°ä½“éƒ¨åˆ†
}
```

åè®®çš„å…³è”ç±»å‹ï¼Œå¹¶ä¸”å¯ä»¥æ·»åŠ çº¦æŸã€‚
```swift
protocol SuffixableContainer: Container {
    associatedtype Suffix: SuffixableContainer where Suffix.Item == Item
    func suffix(_ size: Int) -> Suffix
}
```

someç”¨æ¥ä¿®é¥°ä¸é€æ˜çš„ç±»å‹ï¼Œç†è§£ä¸Šå¯ä»¥å¯¹æ¯”èŒƒå‹ç†è§£ï¼Œæ¯”å¦‚èŒƒå‹å‡½æ•°çš„è¿”å›å€¼ç±»å‹ç”±è°ƒç”¨è€…ä¼ å…¥çš„å‚æ•°å†³å®šï¼Œè€Œä¸åŒåç±»å‹çš„è¿”å›ç±»å‹ç”±å‡½æ•°ä½“å†…å†³å®šã€‚
``` swift
func makeTrapezoid() -> some Shape {
    let top = Triangle(size: 2)
    let middle = Square(size: 2)
    let bottom = FlippedShape(shape: top)
    let trapezoid = JoinedShape(
        top: top,
        bottom: JoinedShape(top: middle, bottom: bottom)
    )
    return trapezoid
}
let trapezoid = makeTrapezoid()
print(trapezoid.draw())
```
åè®®ç±»å‹æ›´å…·çµæ´»æ€§ï¼Œåº•å±‚ç±»å‹å¯ä»¥å­˜å‚¨æ›´å¤šæ ·çš„å€¼ï¼Œè€Œä¸é€æ˜ç±»å‹å¯¹è¿™äº›åº•å±‚ç±»å‹æœ‰æ›´å¼ºçš„é™å®šï¼Œæ¯”å¦‚ã€‚
```swift
func protoFlip<T: Shape>(_ shape: T) -> Shape {
    return FlippedShape(shape: shape)
}
func protoFlip<T: Shape>(_ shape: T) -> Shape {
    if shape is Square {
        return shape
    }

    return FlippedShape(shape: shape)
}
```

ç†è§£å•çº¿ç¨‹ä¸‹ï¼Œä½¿ç”¨inoutå‚æ•°å¯èƒ½ä¼šå¯¼è‡´å†…å­˜è®¿é—®å†²çªçš„é—®é¢˜ã€‚
![](Swift%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/11BBD147-3865-4CDC-8BE9-551F6D213153.png)
```swift
var stepSize = 1

func increment(_ number: inout Int) {
    number += stepSize
}

increment(&stepSize)
// é”™è¯¯ï¼šstepSize è®¿é—®å†²çª
```


openã€publicã€internalã€fileprivateã€ privateè®¿é—®æƒé™ç”±é«˜åˆ°ä½ã€‚

/æ¨¡å—/æŒ‡çš„æ˜¯ç‹¬ç«‹çš„ä»£ç å•å…ƒï¼Œæ¡†æ¶æˆ–åº”ç”¨ç¨‹åºä¼šä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—æ¥æ„å»ºå’Œå‘å¸ƒã€‚åœ¨ Swift ä¸­ï¼Œä¸€ä¸ªæ¨¡å—å¯ä»¥ä½¿ç”¨ importå…³é”®å­—å¯¼å…¥å¦å¤–ä¸€ä¸ªæ¨¡å—ã€‚

Open å’Œclass ä¸€èˆ¬ç”¨æ¥æŒ‡å®šæ¡†æ¶çš„å¤–éƒ¨æ¥å£ï¼Œä½†æ˜¯Open åªèƒ½ä½œç”¨äºç±»å’Œç±»çš„æˆå‘˜ï¼Œå®ƒå’Œ public çš„åŒºåˆ«ä¸»è¦åœ¨äº open é™å®šçš„ç±»å’Œæˆå‘˜èƒ½å¤Ÿåœ¨æ¨¡å—å¤–èƒ½è¢«ç»§æ‰¿å’Œé‡å†™ã€‚
internalæ˜¯é»˜è®¤çš„è®¿é—®çº§åˆ«ã€‚

ä¸€ä¸ªç±»å‹çš„è®¿é—®çº§åˆ«ä¹Ÿä¼šå½±å“åˆ°ç±»å‹/æˆå‘˜/ï¼ˆå±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨ã€ä¸‹æ ‡ï¼‰çš„é»˜è®¤è®¿é—®çº§åˆ«ã€‚å¦‚æœä½ å°†ç±»å‹æŒ‡å®šä¸º privateæˆ–è€… fileprivateçº§åˆ«ï¼Œé‚£ä¹ˆè¯¥ç±»å‹çš„æ‰€æœ‰æˆå‘˜çš„é»˜è®¤è®¿é—®çº§åˆ«ä¹Ÿä¼šå˜æˆ privateæˆ–è€… fileprivateçº§åˆ«ã€‚å¦‚æœä½ å°†ç±»å‹æŒ‡å®šä¸º internalæˆ– publicï¼ˆæˆ–è€…ä¸æ˜ç¡®æŒ‡å®šè®¿é—®çº§åˆ«ï¼Œè€Œä½¿ç”¨é»˜è®¤çš„ internalï¼‰ï¼Œé‚£ä¹ˆè¯¥ç±»å‹çš„æ‰€æœ‰æˆå‘˜çš„é»˜è®¤è®¿é—®çº§åˆ«å°†æ˜¯ internal

å•å…ƒæµ‹è¯• target æ—¶ã€‚é»˜è®¤æƒ…å†µä¸‹åªæœ‰ openæˆ– publicçº§åˆ«çš„å®ä½“æ‰å¯ä»¥è¢«å…¶ä»–æ¨¡å—è®¿é—®ã€‚ç„¶è€Œï¼Œå¦‚æœåœ¨å¯¼å…¥åº”ç”¨ç¨‹åºæ¨¡å—çš„è¯­å¥å‰ä½¿ç”¨ @testableç‰¹æ€§ï¼Œç„¶ååœ¨å…è®¸æµ‹è¯•çš„ç¼–è¯‘è®¾ç½®ï¼ˆBuild Options -> Enable Testabilityï¼‰ä¸‹ç¼–è¯‘è¿™ä¸ªåº”ç”¨ç¨‹åºæ¨¡å—ï¼Œå•å…ƒæµ‹è¯•ç›®æ ‡å°±å¯ä»¥è®¿é—®åº”ç”¨ç¨‹åºæ¨¡å—ä¸­æ‰€æœ‰å†…éƒ¨çº§åˆ«çš„å®ä½“ã€‚

å…ƒç»„çš„è®¿é—®çº§åˆ«å°†ç”±å…ƒç»„ä¸­è®¿é—®çº§åˆ«æœ€ä¸¥æ ¼çš„ç±»å‹æ¥å†³å®šã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ„å»ºäº†ä¸€ä¸ªåŒ…å«ä¸¤ç§ä¸åŒç±»å‹çš„å…ƒç»„ï¼Œå…¶ä¸­ä¸€ä¸ªç±»å‹ä¸º internalï¼Œå¦ä¸€ä¸ªç±»å‹ä¸º privateï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç»„çš„è®¿é—®çº§åˆ«ä¸º privateã€‚

æ— ç¬¦å·æ•°é‡‡ç”¨åŸç ç¼–ç ï¼Œå·¦å³ç§»åŠ¨æ˜¯é€»è¾‘ä½ç§»ï¼Œå³ç§»é™¤2ï¼Œå·¦ç§»ä¹˜2ã€‚
æœ‰ç¬¦å·æ•°é‡‡ç”¨è¡¥ç ç¼–ç ï¼Œå·¦å³ç§»åŠ¨æ˜¯ç®—æœ¯ä½ç§»ï¼Œé‡‡ç”¨è¡¥ç ç¼–ç çš„ä¼˜ç‚¹æ˜¯èƒ½è¾¾åˆ°åŒæ— ç¬¦å·æ•°ä¸€æ ·çš„å³ç§»é™¤2ï¼Œå·¦ç§»ä¹˜2çš„æ•ˆæœã€‚åŒæ—¶åœ¨è¿ç®—ä¸­å¯ä»¥ç›´æ¥æŒ‰ç…§æ ‡å‡†äºŒè¿›åˆ¶å¤„ç†ï¼Œåªéœ€è¦ä¸¢å¼ƒè¶…è¿‡ä½æ•°çš„ç›Šå‡ºã€‚

Swiftæº¢å‡ºè¿ç®—ç¬¦ä¸€èˆ¬ä½¿ç”¨å¸¸è§æ˜¯ï¼Œå½“ä½ å¸Œæœ›è®©ç³»ç»Ÿåœ¨æ•°å€¼æº¢å‡ºçš„æ—¶å€™é‡‡å–æˆªæ–­å¤„ç†ï¼Œè€ŒéæŠ¥é”™æ—¶ï¼Œæº¢å‡ºåŠ æ³• &+ã€æº¢å‡ºå‡æ³• &-ã€æº¢å‡ºä¹˜æ³• &*
```swift
var unsignedOverflow = UInt8.max
// unsignedOverflow ç­‰äº UInt8 æ‰€èƒ½å®¹çº³çš„æœ€å¤§æ•´æ•° 255
unsignedOverflow = unsignedOverflow &+ 1
// æ­¤æ—¶ unsignedOverflow ç­‰äº 0
```
![](Swift%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/7E51F6E0-066C-4241-A309-B5A1A92226B2.png)

``` swift
var signedOverflow = Int8.min
// signedOverflow ç­‰äº Int8 æ‰€èƒ½å®¹çº³çš„æœ€å°æ•´æ•° -128
signedOverflow = signedOverflow &- 1
// æ­¤æ—¶ signedOverflow ç­‰äº 127
```
![](Swift%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/64EE4947-B892-4EEF-8DD3-7EB5E6ECC77A.png)

