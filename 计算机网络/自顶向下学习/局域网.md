# 局域网
#计算机网络/哈工大自顶向下

![](%E5%B1%80%E5%9F%9F%E7%BD%91/02BCCF16-330C-41BF-AF15-C0A983134750.png)
![](%E5%B1%80%E5%9F%9F%E7%BD%91/9806B7BF-2239-41E2-832D-5915D496E8F4.png)
IP地址标示网络层的数据报，mac地址标示数据链路层的帧。

# ARP地址解析协议
![](%E5%B1%80%E5%9F%9F%E7%BD%91/DE82C856-6669-423A-B5F4-9A30D3B236D2.png)

## 同一个局域网内的ARP查询
![](%E5%B1%80%E5%9F%9F%E7%BD%91/9E2C981E-1ABD-4410-A386-9BCC1E6E7D01.png)

## 不同局域网内的ARP查询
![](%E5%B1%80%E5%9F%9F%E7%BD%91/97F1F252-5781-4147-B174-6A7B8A64576C.png)
A如果知道B的IP地址？用户在应用层指定的（比如浏览器访问DNS解析）
A如果知道第一跳路由的接口IP地址？通过默认网关配置（动、静态查询）
A如何知道第一跳路由的接口MAC地址？通过ARP局域网内地址查询

![](%E5%B1%80%E5%9F%9F%E7%BD%91/CD6D44C2-7FC9-4874-AA5C-930075A1806E.png)
![](%E5%B1%80%E5%9F%9F%E7%BD%91/C3825737-F34C-4F53-BE21-3C85629713C6.png)
1.首先A封装数据到数据链路层，因为B不在同一个局域网内所以会把数据帧发送到默认网关（路由器左侧接口），此时数据帧内目的IP地址是B的IP地址，但是目的Mac地址就是路由器左侧接口的Mac地址。
![](%E5%B1%80%E5%9F%9F%E7%BD%91/1610CD35-9547-41AC-B0B6-23374D073FE7.png)
路由器收到数据帧后，进行层次化处理，还是通过ARP局域网地址查询，找到B的mac地址，然后把数据帧发过去。

> 这里说的源和目的IP地址不变，是因为这是2个LAN网络，如果是内网发到公网这种，这里路由器就要进行NAT地址转换，把数据报内的源地址修改为公网网络地址。反过来如果是公网发到内网，则需要修改替换目的地址）  

# 以太网
![](%E5%B1%80%E5%9F%9F%E7%BD%91/DE0E0410-5EA6-4259-84BE-AB474934B86A.png)



